---
- name: Copy the files from server1 to server2
  #  hosts: ansible-node2-rhel76
  hosts: all
  become: yes
  vars:
    - file_name: file1.txt
  tasks:
    - name: First get the required file from source to tower
      fetch:
        src: /tmp/file1.txt
        dest: /tmp/
        flat: yes
- name: Move the file from Ansible to remote
  hosts: all
  become: yes
  vars:
    - file_name: file1.txt
  tasks:
    - name: Copy the file from tower to nmon server
      copy:
        src: /tmp/{{ file_name }}
        dest: /tmp/
      delegate_to: ansible-node3-rhel86
      register: status
    - name: showing the results
      debug:
        var: status
- name: Removing the file from tower
  hosts: all
  become: yes
  vars:
    - file_name: file1.txt

  tasks:
    - name: Remove the file after copying
      file:
        path: /tmp/{{ file_name }}
        state: absent
        # when: status.failed == "false"
      delegate_to: 127.0.0.1
